{
    "swagger": "2.0",
    "info": {
        "version": "1.0.0-201612081256",
        "title": "Управление учетными записями в системе партнера",
        "description": "Запросы, которые управляют клиентскими учетными записями в системе партнера (авторизация существующих, регистрация новых, активация и деактивация тарифов)."
    },
    "schemes": [
        "http",
        "https"
    ],
    "produces": [
        "application/json"
    ],
    "consumes": [
        "application/json"
    ],
    "paths": {
        "/api/v1/user/verify": {
            "post": {
                "summary": "Верификация пользователя ТУ",
                "description": "Выполняет следующие задачи  1) проверка существует ли пользователь в системе партнера  2) проверка билится ли пользователь в системе партнера 3) если в системе партнера испозуется авторизация через token, то его нужно вернуть как параметр в ответе. >\n",
                "parameters": [{
                        "$ref": "#/parameters/serverAuth"
                    }, {
                        "name": "user",
                        "in": "body",
                        "description": "параметры необходимые для получения данных о пользователе",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/user"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Пользователь авторизован",
                        "schema": {
                            "title": "данные пользователя",
                            "type": "object",
                            "required": [
                                "userUuid",
                                "hasBilling"
                            ],
                            "properties": {
                                "userUuid": {
                                    "type": "string",
                                    "description": "уникальный id пользователя в системе Эвотор"
                                },
                                "hasBilling": {
                                    "type": "boolean",
                                    "description": "платит ли пользователь в системе партнера"
                                },
                                "token": {
                                    "description": "опциональный параметр, возвращется если партнер использует авторизацию через token в запросах товароучетного API",
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Авторизация server-to-server не удалась"
                    },
                    "404": {
                        "description": "Пользователь не найден"
                    },
                    "422": {
                        "description": "Пользовательская авторизация не удалась"
                    }
                }
            }
        },
        "/api/v1/user/create": {
            "post": {
                "summary": "Создание пользователя",
                "description": "Создание пользователя в системе партнера",
                "parameters": [{
                        "$ref": "#/parameters/serverAuth"
                    }, {
                        "name": "user",
                        "in": "body",
                        "description": "параметры необходимые для создания пользователя в партнере",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/user"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Пользователь создан",
                        "schema": {
                            "title": "данные пользователя",
                            "type": "object",
                            "required": [
                                "userUuid"
                            ],
                            "properties": {
                                "userUuid": {
                                    "type": "string",
                                    "description": "уникальный id пользователя в системе Эвотор"
                                },
                                "error": {
                                    "type": "string"
                                },
                                "token": {
                                    "description": "опциональный параметр, возвращется если партнер использует авторизацию через token в запросах товароучетного API",
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Авторизация server-to-server не удалась"
                    },
                    "409": {
                        "description": "Пользователь уже существует"
                    }
                }
            }
        },
        "/api/v1/user/tariff": {
            "post": {
                "summary": "Активация / деактивация тарифа ",
                "description": "Установка / деактивация тарифа учетки не только для новых пользователей, но и для ранее созданных учеток НЕ от нашего лица (типа юзер сам заходил ранее и создал)",
                "parameters": [{
                        "$ref": "#/parameters/serverAuth"
                    }, {
                        "name": "user",
                        "in": "body",
                        "description": "параметры необходимые для установки тарифа пользователю в партнере",
                        "required": true,
                        "schema": {
                            "type": "object",
                            "required": [
                                "userUuid"
                            ],
                            "properties": {
                                "userUuid": {
                                    "type": "string",
                                    "description": "уникальный id пользователя в системе Эвотор"
                                },
                                "tariffId": {
                                    "type": "string",
                                    "description": "код тарифа в системе Эвотор"
                                },
                                "status": {
                                    "type": "string",
                                    "enum": [
                                        "ACTIVE",
                                        "INACTIVE"
                                    ]
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful response",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "error": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "parameters": {
        "serverAuth": {
            "name": "Authorization",
            "in": "header",
            "description": "Авторизация Эвотор в системе партнера (Server-to-Server).\nЭто может быть basic auth, API key или token.\nПараметр передается в заголовке запроса, в поле Authorization",
            "required": true,
            "type": "string",
            "pattern": "^(Bearer|Basic) [A-Z0-9_=-]+$"
        }
    },
    "definitions": {
        "user": {
            "type": "object",
            "properties": {
                "userUuid": {
                    "type": "string",
                    "description": "Уникальный идентификатор пользователя в Эвотор",
                    "pattern": "^[0-9]{2}-[0-9]{15}$"
                },
                "username": {
                    "type": "string",
                    "description": "Имя пользователя или логин",
                },
                "password": {
                    "type": "string",
                    "description": "",
                },
                "email": {
                    "type": "string",
                    "description": "Адрес электронной почты",
                },
                "phone": {
                    "type": "string",
                    "description": "Номер телефона"
                },
                "customField": {
                    "type": "string",
                    "description": "Поле для передачи пользовательских атрибутов из Эвотор в систему партнера. Выводится на формах авторизации/регистрации клиента в процессе покупки приложения в маркетплейсе Эвотор. Название поля должно характеризовать его содержимое. Таких полей на форме может быть не больше 5-6. Состав подобных полей должен быть минимален. Не допускается использование полей для ввода информации, которую пользователь может указать в личном кабинете партнера после установки приложения."
                }
            }
        }
    }
}
